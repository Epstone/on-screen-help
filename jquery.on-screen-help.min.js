(function(e,n,i){function j(c){return e("<div class='"+c+"' />")}function q(c){e.each(c,function(b,a){e("."+a).remove()})}function r(c,b,a){this.element=c;this.options=e.extend({},s,a);this.defaults=s;this.name=k;this.steps=b;this.init()}var t=function(c){function b(a){return-1!==d.padding.indexOf("all")||-1!==d.padding.indexOf(a)?f(a):0}function a(a){return-1===d.padding.indexOf("all")&&-1===d.padding.indexOf(a)?f(a):0}function f(a){return parseInt(d.$elem.css("padding-"+a),10)}var d=this;d.selector=
c;d.padding="none";d.caption="?";d.$elem=e(c);d.offsetTop=function(){return d.$elem.offset().top+b("top")};d.offsetBottom=function(){return d.$elem.offset().top+f("top")+d.$elem.height()+a("bottom")};d.offsetLeft=function(){return d.$elem.offset().left+b("left")};d.offsetRight=function(){return d.$elem.offset().left+f("left")+d.$elem.width()+a("right")};d.absHeight=function(){return d.$elem.height()+a("top")+a("bottom")};d.absWidth=function(){return d.$elem.width()+a("left")+a("right")}},l=function(c,
b,a,f){this.x=c;this.y=b;this.width=a;this.height=f},u=function(){this.fadingBlocks=function(c){var b=e(p).width(),a=e(p).height(),f=c.offsetLeft(),d=c.offsetTop(),g=c.offsetRight()+4,h=c.offsetBottom();c.$elem.height();return{b1:new l(0,0,"100%",d),b2:new l(g,d,b-g,c.absHeight()),b3:new l(0,h,"100%",a-h),b4:new l(0,d,f,c.absHeight())}};this.descriptionBottom=function(c,b){var a=b.width()/2;return{x:c.offsetLeft()+c.absWidth()/2-a,y:c.offsetBottom()}};this.descriptionLeft=function(c,b){var a=b.height()/
2;return{x:c.offsetLeft()-b.width(),y:c.offsetTop()+c.absHeight()/2-a}};this.descriptionTop=function(c,b){var a=b.width()/2;return{x:c.offsetLeft()+c.absWidth()/2-a,y:c.offsetTop()-b.height()}};this.descriptionRight=function(c,b){var a=b.height()/2;return{x:c.offsetRight(),y:c.offsetTop()+c.absHeight()/2-a}}},v=function(){function c(a,b){b.$elem.offset();a.css({top:b.offsetTop(),left:b.offsetLeft(),width:b.absWidth(),height:b.absHeight()});b.parent&&(a.hasClass("osh_is_child")||a.addClass("osh_is_child"),
a.css({left:a.offset().left}),a.width(a.width()))}var b=this;b.$b1=new m;b.$b2=new m;b.$b3=new m;b.$b4=new m;b.$descriptionOuter=i;b.$descriptionBubble=i;b.highlight=function(a){a=(new u).fadingBlocks(a);b.$b1.update(a.b1);b.$b2.update(a.b2);b.$b3.update(a.b3);b.$b4.update(a.b4)};b.showDescription=function(a){var c=a.position;b.$descriptionOuter||(b.$descriptionBubble=j("osh_arrow_box"),b.$descriptionOuter=j("osh_arrow_box_outer").append(b.$descriptionBubble),e("body").append(b.$descriptionOuter));
c||(c="bottom");b.$descriptionBubble.removeClass("top bottom left right");b.$descriptionBubble.addClass(c);a.html?b.$descriptionBubble.html(a.html):b.$descriptionBubble.text(a.description);c="description"+(a.position.charAt(0).toUpperCase()+a.position.slice(1));a=(new u)[c](a,b.$descriptionOuter);b.$descriptionOuter.css({top:a.y,left:a.x})};b.reposClickableZones=function(a){e.each(a,function(a,b){c(b.$zone,b)})};b.destroy=function(){q(["osh_arrow_box_outer","osh_block","osh_marked_zone"])};b.buildClickableZones=
function(a,f){e.each(a,function(a,g){var h=j("osh_marked_zone").appendTo("body");c(h,g);e("<div/>").append(e("<p />").text(g.caption)).appendTo(h);g.$zone=h;g.$zone.click(function(){f.call(b,g)})})}},m=function(){var c=this,b=e("<div class='osh_block'/>");e("body").append(b);c.sizeInfo=i;c.update=function(a){b.css({left:a.x,top:a.y,width:a.width,height:a.height});c.sizeInfo=a}},w=function(){var c=this;c.$buttons=i;c.destroy=function(){q(["osh_toolbar","osh_toolbar_background"])};c.createToolbarBasic=
function(b){j("osh_toolbar_background").appendTo("body");c.$buttons=e("<ul class='osh_button_list' />");var a=e("<a class='left osh_button' href='#'>&lt;</a>"),f=e("<a href='#' class='right osh_button' >&gt;</a>"),d=j("osh_toolbar").append([a,f,c.$buttons]);a.click(function(a){a.preventDefault();b.call(c,-1)});f.click(function(a){a.preventDefault();b.call(c,1)});e("body").append(d)};c.createToolbarButtons=function(b,a){e.each(b,function(b,d){var g=e("<a href='#' class='osh_nav_link' />").text(d.navCaption||
d.caption),h=e("<li />").append(g);d.$link=g;g.click(function(b){b.preventDefault();a.call(c,d)});c.$buttons.append(h)})}},x=function(){var c=this,b,a=[],f;this.showDescriptionCallback=this.highlightCallback=i;c.initialize=function(b){var g=0;e.each(b,function(b,c){var d=new t(c.selector);d.index=g;g++;c.startWith&&(f=d);e.extend(d,c);a.push(d)});e.each(a,function(b,c){var d=c.$elem,f;e.each(a,function(a,b){0<d.parents(b.selector).length&&(f=b)});c.parent=f});return c.getSteps()};c.getSteps=function(){return a};
c.activateStep=function(a){a!==b&&(c.highlightCallback.call(c,a),c.showDescriptionCallback.call(c,a),b&&(b.$link.removeClass("active"),b.$zone.show(),b.parent&&b.parent.$zone.show()),a.parent&&a.parent.$zone.hide(),a.$zone.hide(),a.$link.addClass("active"),b=a,a=!a.position||"top"===a.position.toLowerCase()?a.offsetTop()-250:a.offsetTop()-50,e("body, html").animate({scrollTop:a},1E3))};c.nextPrevStep=function(d){b?(d=b.index+d,d>=a.length?d=0:0>d&&(d=a.length-1),c.activateStep(a[d])):c.activateStep(a[0])};
c.showFirstStep=function(){f&&c.activateStep(f)};c.browserResize=function(){b&&c.highlightCallback.call(c,b)}},k="onScreenHelp",p=n.document,s={hideKeyCode:27};r.prototype.init=function(){var c=this,b=new v,a=new x,f=a.initialize(this.steps);a.highlightCallback=b.highlight;a.showDescriptionCallback=b.showDescription;b.buildClickableZones(f,a.activateStep);var d=new w;d.createToolbarBasic(a.nextPrevStep);d.createToolbarButtons(f,a.activateStep);e(n).resize(function(){a.browserResize();b.reposClickableZones(f)});
e(p).keyup(function(a){27==a.keyCode&&(b.destroy(),d.destroy(),e(c.element).removeData("plugin_"+c.name))});a.showFirstStep()};n.osh_testing={Step:t};e.fn[k]=function(c,b){return this.each(function(){e.data(this,"plugin_"+k)||e.data(this,"plugin_"+k,new r(this,c,b))})}})(jQuery,window);